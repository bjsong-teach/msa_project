<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>MSA í”„ë¡œì íŠ¸ ë©”ì¸</title>
    <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="/index.html" class="nav-brand">ğŸš€ MSA Project</a>
            <div class="nav-links">
                <a href="/board_list.html" class="nav-link">ê²Œì‹œíŒ</a>
                <a href="/blog_list.html" class="nav-link">ë¸”ë¡œê·¸</a>
            </div>
            <div id="auth-links" class="nav-auth">
                </div>
        </div>
    </nav>
    <main class="container">
        <div style="text-align: center; background: #fff; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;">
            <h1 style="font-size: 2.5rem; font-weight: bold;">MSA í”„ë¡œì íŠ¸ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!</h1>
            <p style="font-size: 1.2rem; color: #6c757d;">ì´ ì‚¬ì´íŠ¸ëŠ” FastAPIì™€ MSA ê°œë…ìœ¼ë¡œ êµ¬ì„±ëœ ê²Œì‹œíŒê³¼ ë¸”ë¡œê·¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
        </div>

        <div style="display: flex; gap: 2rem;">
            <div style="flex: 1;">
                <h3>ìµœì‹  ê²Œì‹œê¸€</h3>
                <div id="latest-board-posts" class="list-group"></div>
            </div>
            <div style="flex: 1;">
                <h3>ìµœì‹  ë¸”ë¡œê·¸ ê¸€</h3>
                <div id="latest-blog-articles" class="list-group"></div>
            </div>
        </div>
    </main>

    <script src="/assets/js/auth.js"></script>
    <script>
        const boardListEl = document.getElementById('latest-board-posts');
        const blogListEl = document.getElementById('latest-blog-articles');

        async function fetchAndRenderList(url, targetElement, detailPage) {
            targetElement.innerHTML = '<p>ë¡œë”© ì¤‘...</p>';
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('ë°ì´í„° ë¡œë”© ì‹¤íŒ¨');
                const data = await response.json();
                
                targetElement.innerHTML = '';
                if (data.items.length === 0) {
                    targetElement.innerHTML = '<p>ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }
                data.items.forEach(item => {
                    const link = document.createElement('a');
                    link.href = `/${detailPage}?id=${item.id}`;
                    link.className = 'list-item';
                    link.innerHTML = `<strong>${item.title}</strong><small>${item.author_username || 'Unknown'}</small>`;
                    targetElement.appendChild(link);
                });
            } catch (error) {
                targetElement.innerHTML = `<p style="color:red;">${error.message}</p>`;
            }
        }

        const style = document.createElement('style');
        style.innerHTML = `
            .list-group { display: flex; flex-direction: column; gap: 0.5rem; }
            .list-item { 
                display: flex; justify-content: space-between; align-items: center;
                padding: 0.75rem 1rem; background: #fff; border: 1px solid #e9ecef;
                border-radius: 4px; text-decoration: none; color: #343a40;
                transition: background-color 0.2s;
            }
            .list-item:hover { background-color: #f1f1f1; }
            .list-item small { color: #6c757d; }
        `;
        document.head.appendChild(style);

        // í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì‹¤í–‰ë  í•¨ìˆ˜ë“¤
        document.addEventListener('DOMContentLoaded', () => {
            // 1. ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ë„¤ë¹„ê²Œì´ì…˜ ë°” UIë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
            renderNavbar(); 
            
            // 2. ìµœì‹  ê²Œì‹œë¬¼ê³¼ ë¸”ë¡œê·¸ ê¸€ ëª©ë¡ì„ APIë¡œ ìš”ì²­í•˜ì—¬ ê·¸ë¦½ë‹ˆë‹¤.
            fetchAndRenderList('/api/board/posts?page=1&size=5', boardListEl, 'board_detail.html');
            fetchAndRenderList('/api/blog/articles?page=1&size=5', blogListEl, 'blog_detail.html');
        });
    </script>
</body>
</html>